{"remainingRequest":"/Users/alex/Desktop/myproject/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js??vue-loader-options!/Users/alex/Desktop/myproject/src/views/addBar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/alex/Desktop/myproject/src/views/addBar.vue","mtime":1574180823133},{"path":"/Users/alex/Desktop/myproject/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/alex/Desktop/myproject/node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/alex/Desktop/myproject/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/alex/Desktop/myproject/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiYWRkLWJhciIsCiAgZGF0YSgpewogICAgcmV0dXJuIHsKICAgICAgYmFyOiBbXSwKICAgICAgc2hvdzogZmFsc2UsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBmaW5pc2hlZDogZmFsc2UsCiAgICAgIGxpc3Q6IFtdLAogICAgICBwYWdlOiAxLAogICAgICBzaXplOiA1LAogICAgICBhY3RpdmVzOiAiIiwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIGZpbmlzaGVkOiBmYWxzZSwKICAgICAgbmFtZTogIiIsCiAgICAgIHJlbWFyazogIiIKICAgIH0KICB9LAogIG1vdW50ZWQoKXsKICAgIHRoaXMucXVlcnlCeVR5cGUoKQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgc2F2ZSgpewogICAgICAgIGlmKCF0aGlzLmxpc3Quc29tZShlID0+IGUuYWN0aXZlID09PSB0cnVlKSl7CiAgICAgICAgICAgIHJldHVybiB0aGlzLiRub3RpZnkoe3R5cGU6ICJkYW5nZXIiLCBtZXNzYWdlOiAi6K+36YCJ5oup5qih54mIIn0pCiAgICAgICAgfQogICAgICAgIGlmKCF0aGlzLm5hbWUpewogICAgICAgICAgICByZXR1cm4gdGhpcy4kbm90aWZ5KHt0eXBlOiAiZGFuZ2VyIiwgbWVzc2FnZTogIuagh+etvuWQjeensOW/heWhqyJ9KQogICAgICAgIH0KICAgICAgICBsZXQgdmFsdWUgPSBbXTsKICAgICAgICB0aGlzLmxpc3QubWFwKGU9PnsKICAgICAgICAgICAgaWYoZS5hY3RpdmUpIHZhbHVlLnB1c2goZS5pZCk7CiAgICAgICAgfSkKICAgICAgICBsZXQge2RhdGE6IHJlc30gPSBhd2FpdCB0aGlzLiRhcGkuY29tbW9uLnRlbXBhbGVTYXZlKHsKICAgICAgICAgICAgImNvZGUiOiAiIiwgCiAgICAgICAgICAgICJpZCI6ICIiLAogICAgICAgICAgICAibmFtZSI6IHRoaXMubmFtZSwKICAgICAgICAgICAgIm9yZGVyTnVtIjogMCwgCiAgICAgICAgICAgICJyZW1hcmsiOiB0aGlzLnJlbWFyaywgCiAgICAgICAgICAgICJ0eXBlIjogImJhciIsCiAgICAgICAgICAgICJ2YWx1ZSI6IHZhbHVlLmpvaW4oJywnKQogICAgICAgIH0pCiAgICAgICAgaWYocmVzLmNvZGUgPT09ICcwMDAwJyl7CiAgICAgICAgICAgIHRoaXMucXVlcnlCeVR5cGUoKTsKICAgICAgICAgICAgdGhpcy5zaG93ID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuJG5vdGlmeSh7IHR5cGU6ICdzdWNjZXNzJywgbWVzc2FnZTogIuaWsOW7uuaIkOWKnyIgfSkKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgdGhpcy4kbm90aWZ5KHsgdHlwZTogJ2RhbmdlcicsIG1lc3NhZ2U6IHJlcy5tc2cgfSkKICAgICAgICB9CiAgICB9LAogICAgY2hvb3NlKGl0ZW0pewogICAgICAgIGl0ZW0uYWN0aXZlID0gIWl0ZW0uYWN0aXZlOwogICAgfSwKICAgIG9uTG9hZCgpIHsKICAgICAgLy8g5byC5q2l5pu05paw5pWw5o2uCiAgICAgIHRoaXMucXVlcnlBbGxUZW1wbGF0ZSgpCiAgICB9LAogICAgYXN5bmMgcXVlcnlBbGxUZW1wbGF0ZSgpewogICAgICBsZXQge2RhdGE6IHJlc30gPSBhd2FpdCB0aGlzLiRhcGkuY29tbW9uLnF1ZXJ5QWxsVGVtcGxhdGUoewogICAgICAgIHBhZ2VTaXplOiB0aGlzLnNpemUsCiAgICAgICAgcGFnZU51bTogKHRoaXMucGFnZSAtIDEpICogNSArIDEsCiAgICAgICAgYWN0aXZpdHlJZDogISF0aGlzLmFjdGl2ZXMgPyB0aGlzLmFjdGl2ZXMgOiB1bmRlZmluZWQKICAgICAgfSkKICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIHRoaXMucGFnZSsrOwogICAgICBpZihyZXMuY29kZSA9PT0gJzAwMDAnKXsKICAgICAgICBpZihyZXMucmVzdWx0LmRhdGEubGVuZ3RoID09IDApewogICAgICAgICAgdGhpcy5maW5pc2hlZCA9IHRydWU7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIHJlcy5yZXN1bHQuZGF0YS5maWx0ZXIoZT0+ewogICAgICAgICAgICAgICAgZS5hY3RpdmUgPSBmYWxzZSAgIAogICAgICAgICAgICB9KQogICAgICAgICAgICB0aGlzLmxpc3QgPSB0aGlzLmxpc3QuY29uY2F0KHJlcy5yZXN1bHQuZGF0YSk7CiAgICAgICAgfQogICAgICB9ZWxzZXsKICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICB0aGlzLiRub3RpZnkoeyB0eXBlOiAnZGFuZ2VyJywgbWVzc2FnZTogcmVzLm1zZyB9KQogICAgICB9CiAgICB9LAogICAgaXRlbUNsaWNrKGl0ZW0pewogICAgICBpZihpdGVtLmFjdGl2ZSl7CiAgICAgICAgaXRlbS5hY3RpdmUgPSBmYWxzZTsKICAgICAgICB0aGlzLmxpc3QgPSBbXTsKICAgICAgICB0aGlzLnBhZ2UgPSAxOwogICAgICAgIHRoaXMuYWN0aXZlcyA9ICIiOwogICAgICB9ZWxzZXsKICAgICAgICB0aGlzLmJhci5maWx0ZXIoIGUgPT4gewogICAgICAgICAgZS5hY3RpdmUgPSBmYWxzZTsKICAgICAgICB9KQogICAgICAgIGl0ZW0uYWN0aXZlID0gdHJ1ZTsKICAgICAgICB0aGlzLmxpc3QgPSBbXTsKICAgICAgICB0aGlzLnBhZ2UgPSAxOwogICAgICAgIHRoaXMuYWN0aXZlcyA9IGl0ZW0udmFsdWU7CiAgICAgIH0KICAgICAgdGhpcy5xdWVyeUFsbFRlbXBsYXRlKCk7CiAgICB9LAogICAgYXN5bmMgcXVlcnlCeVR5cGUoKXsKICAgICAgdGhpcy4kdG9hc3QubG9hZGluZyh7CiAgICAgICAgbWVzc2FnZTogJ+WKoOi9veS4rS4uLicsCiAgICAgICAgZHVyYXRpb246IDAKICAgICAgfSk7CiAgICAgIGxldCB7ZGF0YTogcmVzfSA9IGF3YWl0IHRoaXMuJGFwaS5jb21tb24ucXVlcnlCeVR5cGUoewogICAgICAgICJ0eXBlIjogImJhciIKICAgICAgfSk7CiAgICAgIHRoaXMuJHRvYXN0LmNsZWFyKCk7CiAgICAgIGlmKHJlcy5jb2RlID09PSAiMDAwMCIpewogICAgICAgIHJlcy5yZXN1bHQuZGF0YS5maWx0ZXIoIGUgPT4gewogICAgICAgICAgZS5hY3RpdmUgPSBmYWxzZTsKICAgICAgICB9KQogICAgICAgIHRoaXMuYmFyID0gcmVzLnJlc3VsdC5kYXRhCiAgICAgIH1lbHNlewogICAgICAgIHRoaXMuJG5vdGlmeSh7IHR5cGU6ICd3YXJuaW5nJywgbWVzc2FnZTogcmVzLm1zZyB9KTsKICAgICAgfQogICAgfSwKICAgIG15QWN0aXZlKCl7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHtwYXRoOiAndGVtcGxhdGVMaXN0J30pCiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["addBar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"addBar.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div class=\"activityList\">\n        <div style=\"background: rgb(248, 248, 248);\">\n            <div class=\"active-wrap\">\n                <div v-for=\"item in bar\" :key=\"item.id\" class=\"item\" :class=\"{'active': item.active || false}\" @click=\"itemClick(item)\">\n                    {{item.name}} <span>{{item.remark}}</span>\n                </div>\n            </div>\n            <van-button type=\"primary\" size=\"large\" @click=\"show = true\">添加标签</van-button>\n            <div class=\"title\">\n                <span style=\"color: red;font-size: 16px;\">选择模板添加标签</span>\n            </div>\n        </div>\n        <van-list\n          v-model=\"loading\"\n          :finished=\"finished\"\n          :offset=\"20\"\n          finished-text=\"没有更多了\"\n          class=\"activity\"\n          @load=\"onLoad\"\n        >\n          <div class=\"item\" v-for=\"item in list\" :key=\"item.id\" :class=\"{'active': item.active}\" @click=\"choose(item)\">\n                <div class=\"img-wrap\">\n                    <img :src=\"item.thumbnail\" width=\"100%\" height=\"100%\"/>\n                </div>\n                <h2>{{item.activityName}}</h2>\n            </div>\n        </van-list>\n        <van-popup\n            v-model=\"show\"\n            position=\"bottom\"\n            :style=\"{ height: '50%' }\"\n            >\n            <van-field v-model=\"name\" required placeholder=\"标签名称\" />\n            <van-field v-model=\"remark\"  placeholder=\"标红tag\" />\n            <van-button type=\"info\" size=\"small\" @click=\"save\">保存</van-button>\n        </van-popup>\n    </div>\n</template>\n<script>\nexport default {\n  name: \"add-bar\",\n  data(){\n    return {\n      bar: [],\n      show: false,\n      loading: false,\n      finished: false,\n      list: [],\n      page: 1,\n      size: 5,\n      actives: \"\",\n      loading: false,\n      finished: false,\n      name: \"\",\n      remark: \"\"\n    }\n  },\n  mounted(){\n    this.queryByType()\n  },\n  methods: {\n    async save(){\n        if(!this.list.some(e => e.active === true)){\n            return this.$notify({type: \"danger\", message: \"请选择模版\"})\n        }\n        if(!this.name){\n            return this.$notify({type: \"danger\", message: \"标签名称必填\"})\n        }\n        let value = [];\n        this.list.map(e=>{\n            if(e.active) value.push(e.id);\n        })\n        let {data: res} = await this.$api.common.tempaleSave({\n            \"code\": \"\", \n            \"id\": \"\",\n            \"name\": this.name,\n            \"orderNum\": 0, \n            \"remark\": this.remark, \n            \"type\": \"bar\",\n            \"value\": value.join(',')\n        })\n        if(res.code === '0000'){\n            this.queryByType();\n            this.show = false;\n            this.$notify({ type: 'success', message: \"新建成功\" })\n        }else{\n            this.$notify({ type: 'danger', message: res.msg })\n        }\n    },\n    choose(item){\n        item.active = !item.active;\n    },\n    onLoad() {\n      // 异步更新数据\n      this.queryAllTemplate()\n    },\n    async queryAllTemplate(){\n      let {data: res} = await this.$api.common.queryAllTemplate({\n        pageSize: this.size,\n        pageNum: (this.page - 1) * 5 + 1,\n        activityId: !!this.actives ? this.actives : undefined\n      })\n      this.loading = false;\n      this.page++;\n      if(res.code === '0000'){\n        if(res.result.data.length == 0){\n          this.finished = true;\n        }else{\n            res.result.data.filter(e=>{\n                e.active = false   \n            })\n            this.list = this.list.concat(res.result.data);\n        }\n      }else{\n        this.finished = true;\n        this.$notify({ type: 'danger', message: res.msg })\n      }\n    },\n    itemClick(item){\n      if(item.active){\n        item.active = false;\n        this.list = [];\n        this.page = 1;\n        this.actives = \"\";\n      }else{\n        this.bar.filter( e => {\n          e.active = false;\n        })\n        item.active = true;\n        this.list = [];\n        this.page = 1;\n        this.actives = item.value;\n      }\n      this.queryAllTemplate();\n    },\n    async queryByType(){\n      this.$toast.loading({\n        message: '加载中...',\n        duration: 0\n      });\n      let {data: res} = await this.$api.common.queryByType({\n        \"type\": \"bar\"\n      });\n      this.$toast.clear();\n      if(res.code === \"0000\"){\n        res.result.data.filter( e => {\n          e.active = false;\n        })\n        this.bar = res.result.data\n      }else{\n        this.$notify({ type: 'warning', message: res.msg });\n      }\n    },\n    myActive(){\n      this.$router.push({path: 'templateList'})\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n\n.title {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  align-items: center;\n  height: 50px;\n}\n.activity {\n  padding: 0px 5px;\n  display: flex;\n  justify-content: flex-start;\n  flex-wrap: wrap;\n  padding-bottom: 1.5rem;\n  background: rgb(248, 248, 248);\n  /deep/ .van-list__loading{\n    width: 375px;\n  }\n  /deep/ .van-list__finished-text{\n    width: 375px;\n  }\n  .item.active{\n      border: 3px solid rgba(100, 248, 81, 1);\n      box-shadow: 0px 0px 15px 1px #64f851;\n  }\n\n  .item {\n    width: 156px;\n    height: 200px;\n    border: 3px solid rgba(100, 248, 81, 0);\n    margin: 10.25px;\n    .img-wrap {\n      border-top-right-radius: 15px;\n      border-top-left-radius: 15px;\n      overflow: hidden;\n      height: 160px;\n      position: relative;\n      span {\n        position: absolute;\n        width: 100%;\n        height: 30px;\n        line-height: 30px;\n        text-align: center;\n        color: #fff;\n        background: rgba(0, 0, 0, 0.541);\n        bottom: 0;\n        left: 0;\n        z-index: 100;\n        font-size: 16px;\n      }\n    }\n    h2 {\n      font-size: 14px;\n      margin: 2px 0;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      padding: 0 5px;\n    }\n    /deep/ .van-button {\n      margin: 10px;\n      width: 60px;\n    }\n  }\n}\n.active-wrap {\n  padding: 10px 5px;\n  display: flex;\n  justify-content: flex-start;\n  flex-wrap: wrap;\n  .item {\n    margin: 5px;\n    padding: 5px 5px;\n    height: 15px;\n    border-radius: 3px;\n    font-size: 12px;\n    background: #fff;\n    border: 1px solid rgb(74, 156, 250);\n    span {\n      color: red;\n      font-size: 6px;\n      margin: 0 0 0 5px;\n      position: relative;\n      top: -3px;\n    }\n  }\n  .item.active {\n    background: rgb(74, 156, 250);\n    color: #fff;\n  }\n}\n/deep/ .van-button--large{\n    width: 75%;\n    margin: 0 12.5%;\n}\n/deep/ .van-button{\n    width: 75%;\n    margin: 20px 12.5%;\n}\n</style>\n"]}]}